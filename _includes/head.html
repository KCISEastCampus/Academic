<meta charset="UTF-8">
<!-- Immediately apply saved theme to avoid flash: reads localStorage before paint -->
<script>try{(function(){var t=localStorage.getItem('site-theme');if(t)document.documentElement.setAttribute('data-bs-theme',t);} )();}catch(e){/* ignore */}</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>{{ page.title | default: site.title | escape }}</title>
<meta name="description" content="{{ page.description | default: site.description | escape }}">
<meta name="theme-color" content="#0b1220">

<!-- Resource hints for performance -->
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="preconnect" href="https://unpkg.com" crossorigin>

<!-- Bootstrap (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<!-- Editor & highlighting themes -->
<link href="/assets/css/gruvbox_dark_rouge.css" rel="stylesheet" media="(prefers-color-scheme: dark)">

<!-- Fonts -->
<link href="/assets/css/fonts/maplemono.css" rel="stylesheet">

<!-- Mermaid & MathJax: minimal inline config before loading scripts -->
<script>
  window.mermaidConfig = { startOnLoad: false, theme: 'dark' };
  window.MathJax = {
    tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], tags: 'ams', tagSide: 'right', packages: {'[+]': ['physics']} },
    options: { enableMenu: false, ignoreHtmlClass: 'tex-ignore' },
    startup: { pageReady: () => { return Promise.resolve(); } }
  };
</script>

<script defer src="https://unpkg.com/mermaid@11.1.1/dist/mermaid.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>

<!-- Site styles & favicon -->
<link rel="stylesheet" href="/assets/css/_variables.css">
<link rel="stylesheet" href="/assets/css/_utilities.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="shortcut icon" href="/assets/favicon.ico">

<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (window.mermaid && window.mermaid.initialize) {
      try { window.mermaid.initialize(window.mermaidConfig || {}); } catch (e) { console.warn('mermaid init failed', e); }
      window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    }
    // Trigger MathJax typeset when MathJax is available
    if (window.MathJax && typeof MathJax.typesetPromise === 'function') {
      MathJax.typesetPromise().then(() => {
        document.dispatchEvent(new Event('mathjaxLoaded'));
      }).catch((err) => { console.warn('MathJax typeset failed', err); });
    } else {
      // fallback: listen for MathJax startup promise
      if (window.MathJax && MathJax.startup && MathJax.startup.promise) {
        MathJax.startup.promise.then(() => {
          if (typeof MathJax.typesetPromise === 'function') {
            MathJax.typesetPromise().then(() => { document.dispatchEvent(new Event('mathjaxLoaded')); });
          }
        }).catch(() => {});
      }
    }
    // notify when MathJax has finished typesetting: listen for mathjaxLoaded if needed elsewhere
    document.addEventListener('mathjaxLoaded', () => { /* placeholder hook */ });
  });

</script>
